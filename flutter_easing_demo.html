<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Flutter-style Curves Demo (by Bilal Nasar)</title>
  <style>
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,'Helvetica Neue',Arial;margin:24px;background:linear-gradient(180deg,#f8fafc,#eef2ff);min-height:100vh;}
    header{display:flex;gap:12px;align-items:center;justify-content:space-between;}
    header h1{color:#0f172a;font-size:24px;font-weight:700;}
    .brand{font-size:14px;color:#64748b;font-weight:600;}
    .stage{width:100%;max-width:880px;height:180px;border:1px solid #cbd5e1;border-radius:12px;padding:12px;margin-top:18px;position:relative;overflow:hidden;background:#fff;box-shadow:0 4px 12px rgba(0,0,0,0.05);}
    .rail{position:absolute;left:12px;right:12px;top:100px;height:4px;background:#e2e8f0;border-radius:2px;}
    .box{width:48px;height:48px;border-radius:8px;background:#0ea5a4;position:absolute;top:76px;left:12px;display:flex;align-items:center;justify-content:center;color:white;font-weight:600;transition:transform .3s ease, background .3s ease;}
    .box.animate{animation: pulse 1s infinite alternate;}
    @keyframes pulse{from{transform:scale(1);}to{transform:scale(1.1);} }
    .controls{display:flex;gap:12px;margin-top:12px;flex-wrap:wrap;}
    label{font-size:14px;color:#334155;}
    select,input[type=range]{padding:6px;border-radius:6px;border:1px solid #cbd5e1;}
    .curve-info{margin-top:12px;color:#334155;}
    .footer{margin-top:20px;color:#475569;font-size:13px;}
    button{padding:8px 12px;border-radius:8px;border:0;background:#2563eb;color:white;cursor:pointer;transition:background .3s;}
    button:hover{background:#1d4ed8;}
    canvas{width:100%;max-width:880px;height:120px;margin-top:12px;background:white;border-radius:8px;border:1px solid #cbd5e1;box-shadow:0 2px 6px rgba(0,0,0,0.05);}
  </style>
</head>
<body>
  <header>
    <h1>Flutter-style Curves Demo</h1>
    <div class="brand">Created by <strong>Bilal Nasar</strong></div>
  </header>

  <p>Pick a curve and press <strong>Play</strong> — the box will animate across the stage using the selected easing function. Below, you can also see the curve graph visualization.</p>

  <div class="controls">
    <div>
      <label for="curve">Curve</label><br>
      <select id="curve"></select>
    </div>
    <div>
      <label for="duration">Duration (ms): <span id="durLabel">800</span></label><br>
      <input id="duration" type="range" min="100" max="3000" value="800">
    </div>
    <div>
      <label for="distance">Distance (px)</label><br>
      <input id="distance" type="range" min="100" max="700" value="640">
    </div>
    <div style="align-self:flex-end">
      <button id="play">Play</button>
      <button id="reset">Reset</button>
    </div>
  </div>

  <div class="stage" id="stage">
    <div class="rail"></div>
    <div class="box" id="box">GO</div>
  </div>

  <canvas id="curveCanvas"></canvas>

  <div class="curve-info" id="info"></div>

  <div class="footer">
    Visualization inspired by Flutter's <code>Curves</code> class and common JS easings. Created with ❤️ by Bilal Nasar.
  </div>

  <script>
    const EASINGS = {
      'linear': {fn: t => t, desc:'Linear — constant speed'},
      'easeInQuad': {fn: t => t*t, desc:'Starts slow, accelerates (Quadratic)'},
      'easeOutQuad': {fn: t => t*(2-t), desc:'Starts fast, decelerates (Quadratic)'},
      'easeInOutQuad': {fn: t => t<0.5?2*t*t:-1+(4-2*t)*t, desc:'Quadratic ease in/out'},
      'easeInCubic': {fn: t => t*t*t, desc:'Cubic ease-in'},
      'easeOutCubic': {fn: t => (--t)*t*t+1, desc:'Cubic ease-out'},
      'easeInOutCubic': {fn: t => t<0.5?4*t*t*t:(t-1)*(2*t-2)*(2*t-2)+1, desc:'Cubic ease in/out'},
      'fastOutSlowIn': {fn: t => cubicBezier(0.4,0,0.2,1)(t), desc:'Flutter default: cubic-bezier(.4,0,.2,1) (approx)'},
      'easeInSine': {fn: t => 1 - Math.cos((t * Math.PI) / 2), desc:'Sine ease-in'},
      'easeOutSine': {fn: t => Math.sin((t * Math.PI) / 2), desc:'Sine ease-out'},
      'easeInOutSine': {fn: t => -(Math.cos(Math.PI*t)-1)/2, desc:'Sine ease in/out'},
      'decelerate': {fn: t => 1 - (1 - t)*(1 - t), desc:'Decelerate-like'},
      'easeOutBack': {fn: t => {const c1=1.70158; const c3=c1+1; return 1 + c3*Math.pow(t-1,3) + c1*Math.pow(t-1,2);}, desc:'Overshoots and settles (back)'},
      'bounceOut': {fn: t => bounceOut(t), desc:'Bounce at the end'},
      'elasticOut': {fn: t => elasticOut(t), desc:'Springy elastic at the end'},
    };

    function bounceOut(t){
      const n1 = 7.5625, d1 = 2.75;
      if (t < 1 / d1) { return n1 * t * t; }
      else if (t < 2 / d1) { return n1 * (t -= 1.5 / d1) * t + 0.75; }
      else if (t < 2.5 / d1) { return n1 * (t -= 2.25 / d1) * t + 0.9375; }
      else { return n1 * (t -= 2.625 / d1) * t + 0.984375; }
    }

    function elasticOut(t){
      const c4 = (2 * Math.PI) / 3;
      return t === 0 ? 0 : t === 1 ? 1 : Math.pow(2, -10 * t) * Math.sin((t * 10 - 0.75) * c4) + 1;
    }

    function cubicBezier(x1, y1, x2, y2){
      function A(aA1, aA2){ return 1.0 - 3.0*aA2 + 3.0*aA1; }
      function B(aA1, aA2){ return 3.0*aA2 - 6.0*aA1; }
      function C(aA1){ return 3.0*aA1; }
      function calcBezier(aT,aA1,aA2){ return ((A(aA1,aA2)*aT + B(aA1,aA2))*aT + C(aA1))*aT; }
      function getSlope(aT,aA1,aA2){ return 3.0*A(aA1,aA2)*aT*aT + 2.0*B(aA1,aA2)*aT + C(aA1); }
      return function(t){
        var x = t, currentT = t;
        for (var i=0;i<8;i++){
          var xEst = calcBezier(currentT, x1, x2) - x;
          var d = getSlope(currentT, x1, x2);
          if (Math.abs(xEst) < 1e-6) break;
          if (Math.abs(d) < 1e-6) break;
          currentT = currentT - xEst / d;
        }
        return calcBezier(currentT, y1, y2);
      }
    }

    const select = document.getElementById('curve');
    Object.keys(EASINGS).forEach(k=>{
      const opt = document.createElement('option'); opt.value=k; opt.textContent=k; select.appendChild(opt);
    });

    const box = document.getElementById('box');
    const info = document.getElementById('info');
    const durationInput = document.getElementById('duration');
    const durLabel = document.getElementById('durLabel');
    const distanceInput = document.getElementById('distance');
    const canvas = document.getElementById('curveCanvas');
    const ctx = canvas.getContext('2d');

    durationInput.addEventListener('input', ()=> durLabel.textContent = durationInput.value);

    function drawCurve(fn){
      ctx.clearRect(0,0,canvas.width,canvas.height);
      ctx.strokeStyle = '#2563eb';
      ctx.lineWidth = 2;
      ctx.beginPath();
      for(let i=0;i<=100;i++){
        const t=i/100;
        const x=t*canvas.width;
        const y=(1-fn(t))*canvas.height;
        if(i===0) ctx.moveTo(x,y); else ctx.lineTo(x,y);
      }
      ctx.stroke();
    }

    function animateOnce(easingName, duration, distance){
      const fn = EASINGS[easingName].fn;
      info.textContent = EASINGS[easingName].desc || '';
      drawCurve(fn);
      box.classList.add('animate');
      const start = performance.now();
      const startLeft = 12;
      function step(now){
        const t = Math.min(1, (now - start)/duration);
        const p = fn(t);
        box.style.left = startLeft + p*distance + 'px';
        if (t < 1) requestAnimationFrame(step); else box.classList.remove('animate');
      }
      requestAnimationFrame(step);
    }

    document.getElementById('play').addEventListener('click', ()=>{
      const curve = select.value;
      const dur = parseInt(durationInput.value,10);
      const dist = parseInt(distanceInput.value,10);
      box.style.left = '12px';
      setTimeout(()=> animateOnce(curve, dur, dist), 50);
    });

    document.getElementById('reset').addEventListener('click', ()=>{ box.style.left='12px'; info.textContent=''; ctx.clearRect(0,0,canvas.width,canvas.height); });

    select.value='fastOutSlowIn';
    drawCurve(EASINGS['fastOutSlowIn'].fn);
  </script>
</body>
</html>
